<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />
  <title>Instruksi Lapangan - Alfamart</title>
  <link rel="icon" href="../assets/favicon.ico" type="image/x-icon">
  
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="style.css" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
</head>

<body>
  <header>
    <a href="/">
      <img src="../assets/Alfamart-Emblem.png" alt="Alfamart Logo" class="header-logo" />
    </a>
    <h1>Form Instruksi Lapangan</h1>
    <a href="../opname/index.html" class="btn-back-header">
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <line x1="19" y1="12" x2="5" y2="12"></line>
        <polyline points="12 19 5 12 12 5"></polyline>
      </svg>
      <span>
        Opname
      </span>
    </a>
  </header>

  <div class="container">
    <form id="form" class="form-container">
      <label for="nama_toko">Nama Toko: <span class="required-asterisk">*</span></label>
      <input type="text" id="nama_toko" name="Nama_Toko" placeholder="Masukkan nama toko" required
        style="margin-bottom: 15px" />
      
      <label for="lokasi_cabang">Nomor Ulok: <span class="required-asterisk">*</span></label>
      <div style="margin-bottom: 5px;">
            <input type="checkbox" id="toggle_renovasi" style="width: auto; margin-right: 5px;">
            <label for="toggle_renovasi" style="display: inline; font-weight: normal; cursor: pointer;">Proyek Renovasi (Format Baru)</label>
      </div>
      
      <div id="nomor-ulok-container" style="display: flex; gap: 10px; align-items: center; flex-wrap: wrap">
        <select id="lokasi_cabang" required style="flex: 1 1 80px">
          <option value="">-- Kode --</option>
        </select>
        <span style="font-weight: bold">-</span>
        <input type="text" id="lokasi_tanggal" placeholder="YYMM" maxlength="4"
          oninput="this.value = this.value.replace(/[^0-9]/g, '')" required style="flex: 1 1 80px" />
        <span style="font-weight: bold">-</span>
        <input type="text" id="lokasi_manual" placeholder="0001" maxlength="4" required style="flex: 1 1 80px" />
        <span id="separator_renov" style="font-weight: bold; display: none;">-</span>
        <input type="text" id="suffix_renov" value="R" readonly style="flex: 0 0 40px; text-align: center; background-color: #e9ecef; display: none; color: #555;"/>
      </div>
      <input type="hidden" id="lokasi" name="Nomor Ulok" />

      <label for="proyek">Proyek:</label>
      <select name="Proyek" id="proyek" required>
        <option value="">-- Pilih Jenis Proyek --</option>
        <option value="Alfamart Reguler">Reguler</option>
        <option value="Franchise">Franchise</option>
        <option value="Renovasi">Renovasi</option>
      </select>

      <label for="alamat">Alamat Toko: <span class="required-asterisk">*</span></label>
      <input type="text" id="alamat" name="Alamat" placeholder="Masukkan alamat lengkap proyek" required />

      <label for="cabang">Cabang: <span class="required-asterisk">*</span></label>
      <select name="Cabang" id="cabang" required>
        <option value="">-- Cabang Terisi Otomatis --</option>
      </select>

      <label for="lingkup_pekerjaan">Lingkup Pekerjaan: <span class="required-asterisk">*</span></label>
      <select name="Lingkup_Pekerjaan" id="lingkup_pekerjaan" required>
        <option value="">-- Pilih Lingkup Pekerjaan --</option>
        <option value="Sipil">Sipil</option>
        <option value="ME">ME</option>
      </select>

      <label for="attachment_pdf">Lampiran Instruksi Lapangan (PDF Max 1 File): <span
          class="required-asterisk">*</span></label>
      <div class="file-upload-wrapper" style="position: relative;">
        <div id="file-upload-text">
          Klik di sini atau seret file PDF Anda.
          <br>
          <span class="file-info-label">Belum ada file dipilih.</span>
        </div>
        <input type="file" id="attachment_pdf" name="file_pdf" accept=".pdf" required />
      </div>

      <label for="instruksi_pdf">Jika File Lebih Dari 1, Gabungkan File PDF</label>
      <a href="https://pdf-combine-beta.vercel.app/" target="_blank" class="button-merge-pdf" role="button">
        Gabungkan File PDF
      </a>

      <div class="all-tables-container">
        <div id="sipil-tables-wrapper" class="hidden"></div>
        <div id="me-tables-wrapper" class="hidden"></div>
      </div>

      <div class="mt-6 p-4 grand-total-box" style="background-color: #f8f9fa; border: 1px solid #ced4da; border-radius: 8px;">
            <div style="display: flex; justify-content: space-between; margin-bottom: 8px; color: #555;">
                <span class="text-lg font-bold">Total:</span>
                <span id="grand-total-amount" class="text-xl font-bold">Rp 0</span>
            </div>

            <div style="display: flex; justify-content: space-between; margin-bottom: 4px; color: #555;">
                <span class="text-md">Pembulatan:</span>
                <span id="pembulatan-amount" class="text-md font-medium">Rp 0</span>
            </div>

            <div style="display: flex; justify-content: space-between; margin-bottom: 8px; color: #555;">
                <span class="text-md">PPN 11%:</span>
                <span id="ppn-amount" class="text-md font-medium">Rp 0</span>
            </div>

            <hr style="border-top: 1px solid #bbb; margin: 10px 0;">

            <div style="display: flex; justify-content: space-between; align-items: center;">
                <span class="text-lg font-bold" style="color: #0056b3;">Grand Total:</span>
                <span id="final-total-amount" class="text-2xl font-extrabold" style="color: #0056b3;">Rp 0</span>
            </div>
        </div>

      <div class="button-group">
        <button type="submit" id="submit-button">Kirim</button>
        <button type="reset">Ulang</button>
      </div>
    </form>
  </div>

  <div id="message" role="status" aria-live="polite"></div>

  <script src="script.js"></script>
</body>
</html>