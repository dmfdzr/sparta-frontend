<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#dc2626" />
    <meta name="description" content="Foto Dokumentasi Bangunan Toko Baru" />
    <title>Foto Dokumentasi Bangunan Toko Baru</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
    <link rel="stylesheet" href="style.css" />
</head>
<body>
    <noscript>You need to enable JavaScript to run this app.</noscript>

    <div id="app" class="App">
        <div id="login-view" class="view-container">
            <div class="login-box">
                <div class="login-logo">
                    <img src="https://i.ibb.co/vzDRq9L/logoalfamart.png" alt="Alfamart Logo" id="logo-img" />
                    </div>
                <h2>Building & Maintenance</h2>
                <p class="subtitle">Foto Dokumentasi Bangunan Toko Baru</p>

                <div id="login-info" class="info-banner hidden"></div>

                <form id="login-form">
                    <div class="form-group mb-3">
                        <label>Username</label>
                        <input type="text" id="username" placeholder="Masukkan username" required />
                    </div>
                    <div class="form-group mb-4">
                        <label>Password</label>
                        <div class="password-wrapper">
                            <input type="password" id="password" placeholder="Masukkan password" required />
                            <button type="button" id="toggle-password" class="btn-icon">
                                <i class="fa-solid fa-eye"></i>
                            </button>
                        </div>
                    </div>
                    <div id="login-error" class="error-banner hidden"></div>
                    <button type="submit" id="btn-login" class="btn-primary full-width">Login</button>
                </form>
            </div>
        </div>

        <div id="main-layout" class="view-container hidden">
            <header class="app-header">
                <div class="header-top">
                    <h1>FOTO DOKUMENTASI BANGUNAN TOKO BARU ALFAMART</h1>
                </div>
                <div class="header-bottom">
                    <span class="header-left" id="user-branch-display">Building & Maintenance</span>
                    <button class="btn-logout" id="btn-logout">Logout</button>
                </div>
            </header>

            <main class="main-content">
                
                <div id="step-form" class="step-view">
                    <div class="data-form-container">
                        <div class="form-header">
                            <h2>Form Input Dokumentasi</h2>
                            <p>Lengkapi data berikut sebelum mengambil foto dokumentasi</p>
                        </div>
                        
                        <div id="form-toast" class="status-toast hidden"></div>

                        <form id="data-form">
                            <div class="form-grid">
                                <div class="form-group">
                                    <label>Cabang *</label>
                                    <input type="text" id="input-cabang" readonly class="readonly-input" />
                                </div>

                                <div class="form-group">
                                    <label>Nomor Ulok</label>
                                    <div class="ulok-wrapper">
                                        <select id="select-ulok" class="form-control">
                                            <option value="">-- pilih nomor ulok --</option>
                                        </select>
                                        <input type="text" id="input-ulok-manual" class="form-control hidden" placeholder="Contoh: Z001-2510-0001" />
                                    </div>
                                    <div class="checkbox-wrapper">
                                        <span>Input manual (contoh: Z001-2510-0001)</span>
                                        <input type="checkbox" id="check-manual-ulok" />
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label>Kontraktor Sipil *</label>
                                    <input type="text" id="input-sipil" placeholder="Isi nama kontraktor sipil" />
                                </div>

                                <div class="form-group">
                                    <label>Kontraktor ME *</label>
                                    <input type="text" id="input-me" placeholder="Isi nama kontraktor ME" />
                                </div>

                                <div class="form-group">
                                    <label>SPK Awal *</label>
                                    <input type="date" id="input-spk-awal" class="form-control" />
                                </div>

                                <div class="form-group">
                                    <label>SPK Akhir *</label>
                                    <input type="date" id="input-spk-akhir" class="form-control" />
                                </div>

                                <div class="form-group">
                                    <label>Nama Toko *</label>
                                    <input type="text" id="input-nama-toko" required />
                                </div>

                                <div class="form-group">
                                    <label>Kode Toko *</label>
                                    <input type="text" id="input-kode-toko" maxlength="4" required />
                                </div>

                                <div class="form-group">
                                    <label>Tanggal GO *</label>
                                    <input type="date" id="input-tgl-go" class="form-control" />
                                </div>

                                <div class="form-group">
                                    <label>Tanggal ST *</label>
                                    <input type="date" id="input-tgl-st" class="form-control" />
                                </div>

                                <div class="form-group">
                                    <label>Tanggal Ambil Foto *</label>
                                    <input type="date" id="input-tgl-foto" class="form-control" />
                                </div>
                            </div>

                            <div class="form-actions">
                                <button type="submit" id="btn-submit-form" class="btn-primary">Lanjut ke Foto</button>
                            </div>
                        </form>
                    </div>
                </div>

                <div id="step-floorplan" class="step-view hidden">
                    <div class="floor-plan-container">
                        <div class="floor-plan-header">
                            <button id="btn-back-form" class="btn-back">‚Üê Kembali ke Form</button>
                            <div class="store-info">
                                <h2 id="display-store-name">Nama Toko - Kode</h2>
                                <p>Tanggal: <span id="display-date">-</span></p>
                            </div>
                            <div class="progress-info">
                                <span id="progress-text">Progress: 0/38 foto</span>
                                <div class="progress-bar">
                                    <div id="progress-fill" class="progress-fill" style="width: 0%"></div>
                                </div>
                            </div>
                        </div>

                        <div class="floor-plan-content">
                            <div class="floor-plan-wrapper">
                                <div class="floor-plan-image">
                                    <img id="floor-image" src="" alt="Floor Plan" class="floor-plan-bg" />
                                    <div id="points-container">
                                        </div>
                                </div>
                                <div class="pagination-controls">
                                    <button class="pagination-btn active" data-page="1">1</button>
                                    <button class="pagination-btn" data-page="2">2</button>
                                    <button class="pagination-btn" data-page="3">3</button>
                                </div>
                            </div>

                            <div class="photo-list-container">
                                <h3>Daftar Foto (<span id="count-completed">0</span>/38)</h3>
                                <div class="photo-list">
                                    <div id="photo-grid" class="photo-grid">
                                        </div>
                                </div>
                            </div>
                        </div>
                        
                        <div id="completion-section" class="completion-section hidden">
                            <h2>üéâ Semua Foto Berhasil Diambil!</h2>
                            <p>38 foto dokumentasi telah berhasil dikumpulkan.</p>
                            <button id="btn-save-pdf" class="btn-primary">Simpan & Kirim PDF</button>
                        </div>
                    </div>
                </div>

            </main>
        </div>

        <div id="camera-modal" class="camera-modal hidden">
            <div class="camera-container">
                <div class="camera-header">
                    <h3 id="camera-title">Foto #X</h3>
                    <button id="btn-close-camera" class="btn-close">√ó</button>
                </div>
                <div class="camera-content">
                    <div id="camera-preview-box" class="camera-preview">
                        <video id="camera-video" autoplay playsinline muted class="camera-video"></video>
                        <div class="camera-overlay">
                            <div class="camera-frame"></div>
                        </div>
                    </div>
                    <div id="photo-result-box" class="photo-preview hidden">
                        <img id="captured-image" class="captured-image" />
                    </div>
                    <canvas id="camera-canvas" style="display: none;"></canvas>
                </div>
                <div class="camera-controls">
                    <div id="action-pre-capture" class="capture-actions">
                        <button id="btn-capture" class="btn-capture">üì∑ Ambil Foto</button>
                        
                        <label class="btn-secondary upload-label">
                            üì§ Upload Foto
                            <input type="file" id="input-upload-file" accept="image/*" style="display: none;" />
                        </label>
                        
                        <button id="btn-no-photo" class="btn-secondary">üö´ Tidak Bisa Difoto</button>
                    </div>
                    <div id="action-post-capture" class="capture-actions hidden">
                        <button id="btn-retake" class="btn-secondary">üîÑ Ambil Ulang</button>
                        <button id="btn-confirm-photo" class="btn-primary">‚úì Gunakan Foto</button>
                    </div>
                </div>
            </div>
        </div>

        <div id="warning-modal" class="modal-overlay hidden">
            <div class="modal-box warning">
                <div class="icon-circle warning-icon">!</div>
                <h3 style="color: #b67a00; font-weight: 700; margin-bottom: 6px;">Warning</h3>
                <p id="warning-message" style="color: #5a4b00; white-space: pre-line; margin-bottom: 10px;"></p>
                <button id="btn-warning-close" class="btn-warning-close">OK</button>
            </div>
        </div>

        <div id="global-loader" class="modal-overlay hidden" style="z-index: 9999;">
            <div style="background: #fff; padding: 20px 30px; border-radius: 8px; font-weight: 600;">
                <span id="loader-text">Loading...</span>
            </div>
        </div>

        <div id="toast-notification" class="hidden"></div>
    </div>

    <script src="script.js"></script>
</body>
</html>